(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[241],{4886:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var l=s(7876),a=s(4232),r=s(2964),n=s(8600);function i(e){let{selected:t,onSelect:s}=e,[i,o]=(0,a.useState)(""),[d,c]=(0,a.useState)(null),[u,m]=(0,a.useState)([]),[x,h]=(0,a.useState)([]),[g,p]=(0,a.useState)(!1),y=(0,r.aU)(n.yA);(0,a.useEffect)(()=>{(async()=>{h((await (0,r.GG)((0,r.rJ)(y,"ingredients"))).docs.map(e=>({id:e.id,...e.data()})))})()},[]),(0,a.useEffect)(()=>{p(!0);let e=setTimeout(()=>{m(x.filter(e=>{var t,s,l,a,r,n;let o=null!=(a=null==(s=e.name)||null==(t=s.tr)?void 0:t.toLowerCase())?a:"",c=null!=(r=null==(l=e.category)?void 0:l.toLowerCase())?r:"",u=null!=(n=null==d?void 0:d.toLowerCase())?n:null;return o.includes(i.toLowerCase())&&(!u||c===u)})),p(!1)},200);return()=>clearTimeout(e)},[i,d,x]);let b=Array.from(new Set(x.map(e=>e.category))),f=(e,l)=>{"Enter"!==e.key&&" "!==e.key||t.some(e=>e.id===l.id)||s(l)};return(0,l.jsx)("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-gray-500 bg-opacity-75",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-lg max-w-lg w-full max-h-[80vh] overflow-y-auto p-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Malzeme Se\xe7"}),(0,l.jsx)("input",{type:"text",placeholder:"Ara...",value:i,onChange:e=>o(e.target.value),className:"border px-2 py-1 w-full mb-2"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,l.jsx)("button",{onClick:()=>c(null),className:"px-3 py-1 rounded ".concat(d?"bg-gray-100":"bg-gray-800 text-white"),children:"T\xfcm Kategoriler"}),b.map(e=>(0,l.jsx)("button",{onClick:()=>c(e),className:"px-3 py-1 rounded ".concat(d===e?"bg-gray-800 text-white":"bg-gray-100"),children:e},e))]}),g?(0,l.jsx)("div",{className:"text-center py-4",children:"Y\xfckleniyor..."}):(0,l.jsx)("ul",{className:"space-y-1",children:u.map(e=>(0,l.jsxs)("li",{onClick:()=>!t.some(t=>t.id===e.id)&&s(e),onKeyDown:t=>f(t,e),tabIndex:0,className:"cursor-pointer p-1 ".concat(t.some(t=>t.id===e.id)?"bg-gray-200 cursor-not-allowed":"hover:bg-gray-100"),children:[e.emoji&&(0,l.jsx)("span",{style:{marginRight:"0.5rem"},children:e.emoji}),e.name.tr]},e.id))})]})})}var o=s(7627),d=s(9917);let c=(0,r.aU)(n.yA);function u(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0),[u,m]=(0,a.useState)(!1),[x,h]=(0,a.useState)(null),[g,p]=(0,a.useState)(null),[y,b]=(0,a.useState)(0),[f,j]=(0,a.useState)("tumu"),[N,w]=(0,a.useState)(null);(0,a.useEffect)(()=>{{let e=localStorage.getItem("cihazMarkasi");"thermomix"===e||"thermogusto"===e?j(e):j("tumu")}(async()=>{let e=(0,d.xI)().currentUser;if(!e)return;let t=(0,r.H9)(c,"users",e.uid),s=await (0,r.x7)(t);s.exists()&&w(s.data().recipeCredits||0)})()},[x]);let E=async()=>{if(m(!0),p(null),h(null),b(0),null!==N&&N<=0){window.location.href="/kredi-satin-al";return}try{let t=await fetch("/api/generate-recipe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ingredients:e,cihazMarkasi:f})}),s=await t.json();if(!t.ok)throw Error(s.error||"Sunucu hatası");if(!s||!s.steps||!s.ingredients)throw Error("Tarif verisi eksik");if(h(s),null!==N&&N>0){let e=(0,d.xI)().currentUser;if(e){let t=(0,r.H9)(c,"users",e.uid);await (0,r.mZ)(t,{recipeCredits:N-1}),w(N-1)}}}catch(e){p(e.message||"Tarif oluşturulamadı.")}finally{m(!1)}};return(0,l.jsxs)("div",{className:"p-6 min-h-screen bg-gradient-to-br from-yellow-50 to-green-100 text-gray-900",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Kendi Tarifini Oluştur"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2 mb-4 max-h-24 overflow-y-auto",children:e.map(s=>(0,l.jsxs)("span",{className:"bg-gray-200 px-3 py-1 rounded-full text-sm flex items-center",children:[s.emoji," ",s.name.tr,(0,l.jsx)("button",{onClick:()=>t(e.filter(e=>e.id!==s.id)),className:"ml-2 text-red-600",children:"✕"})]},s.id))}),(0,l.jsx)("button",{onClick:()=>n(!0),className:"bg-blue-600 text-white px-4 py-2 rounded mb-4",children:"Malzeme Ekle"}),s&&(0,l.jsx)(i,{selected:e,onSelect:s=>{e.find(e=>e.id===s.id)||t([...e,s])},onClose:()=>n(!1)}),(0,l.jsx)("button",{onClick:E,disabled:u||0===e.length,className:"bg-green-600 text-white px-6 py-2 rounded shadow disabled:bg-gray-400",children:u?"Oluşturuluyor...":"Tarif Oluştur"}),g&&(0,l.jsxs)("p",{className:"text-red-600 mt-4",children:["Hata: ",g]}),x&&(0,l.jsx)("div",{className:"mt-6 bg-white p-6 rounded shadow",children:0===y?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("h2",{className:"text-xl font-bold mb-2",children:["\uD83D\uDCCB ",x.title||"Başlık yok"]}),(0,l.jsx)("p",{className:"italic text-sm mb-2",children:x.summary||"\xd6zet yok"}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"S\xfcre:"})," ",x.duration||"Belirtilmemiş"]}),(0,l.jsx)("h3",{className:"font-semibold mt-4",children:"Malzemeler:"}),(0,l.jsx)("ul",{className:"list-disc list-inside mb-4 max-h-32 overflow-y-auto",children:x.ingredients.map((e,t)=>(0,l.jsx)("li",{children:e},t))}),(0,l.jsx)("button",{onClick:()=>b(1),className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Adımları G\xf6r"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["\uD83C\uDF73 Hazırlık Adımı ",y," / ",x.steps.length]}),(0,l.jsx)("p",{className:"mb-4",children:x.steps[y-1]}),(0,l.jsxs)("div",{className:"flex gap-4",children:[y>1&&(0,l.jsx)("button",{onClick:()=>b(e=>e-1),className:"bg-gray-300 px-4 py-2 rounded",children:"Geri"}),y<x.steps.length?(0,l.jsx)("button",{onClick:()=>b(e=>e+1),className:"bg-green-600 text-white px-4 py-2 rounded",children:"Sonraki"}):(0,l.jsx)("button",{onClick:()=>b(0),className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Baştan G\xf6ster"})]})]})}),(0,l.jsx)(o.A,{})]})}},7627:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var l=s(7876),a=s(9917),r=s(4232),n=s(8600);function i(){let[e,t]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=(0,a.xI)().onAuthStateChanged(e=>{t(e)});return()=>e()},[]);let s=async()=>{try{await (0,a.df)(n.j2,n.Mn)}catch(e){console.error("Login failed:",e)}},i=async()=>{try{await (0,a.CI)(n.j2),t(null)}catch(e){console.error("Logout failed:",e)}};return(0,l.jsx)("div",{className:"mt-10 text-center text-sm text-gray-700",children:e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("p",{children:["\uD83D\uDC4B Hoş geldin, ",e.displayName||"Kullanıcı"]}),(0,l.jsx)("button",{onClick:i,className:"text-blue-600 underline mt-1",children:"\xc7ıkış Yap"})]}):(0,l.jsxs)("button",{onClick:s,className:"bg-white text-gray-800 font-semibold px-6 py-2 mt-4 border border-gray-300 rounded-lg shadow-sm hover:shadow-md flex items-center gap-2 mx-auto",children:[(0,l.jsx)("img",{src:"https://developers.google.com/identity/images/g-logo.png",alt:"Google",className:"w-5 h-5"}),"Google ile Giriş Yap"]})})}},7898:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/custom",function(){return s(4886)}])},8600:(e,t,s)=>{"use strict";s.d(t,{Mn:()=>x,db:()=>c,j2:()=>m,lU:()=>u,yA:()=>d});var l=s(6042),a=s(9591),r=s(9917),n=s(2964),i=s(5364);let o={apiKey:i.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:i.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:i.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:i.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:i.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:i.env.NEXT_PUBLIC_FIREBASE_APP_ID,measurementId:i.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID},d=(0,l.Dk)().length?(0,l.Sx)():(0,l.Wp)(o);(0,a.TT)().then(e=>{e&&(0,a.P5)(d)});let c=(0,n.aU)(d),u=async e=>{let t=(0,n.H9)(c,"users",e);await (0,n.mZ)(t,{recipeCredits:(0,n.GV)(-1)})},m=(0,r.xI)(d),x=new r.HF}},e=>{var t=t=>e(e.s=t);e.O(0,[671,329,205,636,593,792],()=>t(7898)),_N_E=e.O()}]);